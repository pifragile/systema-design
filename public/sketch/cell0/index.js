let cs=2e3,cs2=.5*cs,palettes=["https://coolors.co/fff275-ff8c42-ff3c38-a23e48-6c8ead-083d77-220901-621708-919098-cab6cd"];palettes=["https://coolors.co/ebe7dc-ed4316-0d52da-f399bf-0c8d55-f3be0b","https://coolors.co/f8dbbb-0065bd-ffb700-e02d26","https://coolors.co/393e46-00adb5-f8b500-fc3c3c-ffffff","https://coolors.co/ffaea3-f5ae05-ffe9bd-fd2c05"],palettes=["https://coolors.co/818181-ffffff-000000-00ffff-ffff00-00ff00-ff0000-ff00ff-0000ff"];let permutePalettes=!0;function numToArr(t,e){return[...Array(e)].map((e,r)=>t>>r&1)}function arrToNum(t,e){let r=0;for(let o=0;o<e;o++)r+=Math.pow(2,o)*t[o];return r}function getRandomState(){let t=[];for(let e=0;e<4*numFields;e++)t[e]=Math.round(random());return t}function computeNextState(t){let e=t.length,r=[];for(let o=0;o<t.length;o+=2){let a=arrToNum([t[(o-2).mod(e)],t[(o-1).mod(e)],t[o.mod(e)],t[(o+1).mod(e)],t[(o+2).mod(e)],t[(o+3).mod(e)]],6);r.push(...ruleArray.slice(a,a+2))}return r}const sum=t=>t.reduce((t,e)=>t+e,0),aMinor=[440,493.88,523.25,587.33,659.25,698.46,783.99,880];function renderState(){let t=cs/numFields;for(let e=0;e<numFields;e++){let r=currentState.slice(2*e,2*e+2);pg.fill(palette[arrToNum(r,2)]),pg.rect(e*t,(frameCount-1)%numFields*t,t,t)}playing&&(osc.freq(200*sum(currentState)),osc.amp(1,.1))}let rule=Math.pow(2,16),ruleArray=numToArr(rule,128);const numFields=32;let currentState,osc,playing,freq,amp;function setup(){setSeeds(inputHash);let t=min(windowHeight,windowWidth),e=createCanvas(t,t);pg=createGraphics(cs,cs),pg.pixelDensity(2),pg.colorMode(HSB),setPalette(),e.mousePressed(playOscillator),osc=new p5.Oscillator("sawtooth"),random(),currentState=getRandomState()}function playOscillator(){osc.start(),playing=!0}function makeSketch(){frameRate(20),frameCount%(4*numFields)==1&&(ruleArray=numToArr(rule+=314,128)),pg.noStroke(),pg.strokeWeight(.01*cs),renderState(),currentState=computeNextState(currentState),random()<.03&&(currentState=currentState.map(t=>random()<.01?(t+1)%2:t))}